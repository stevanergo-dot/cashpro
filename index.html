<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CashPro</title>
<link rel="manifest" href="manifest.json">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="bg-[#0f172a] text-white min-h-screen">

<div class="p-4 pb-24">

<h1 class="text-xl font-semibold mb-6">CashPro</h1>

<!-- TOTAL OVERVIEW -->
<div class="bg-[#1e293b] p-5 rounded-3xl mb-6 shadow-lg">
  <p class="text-slate-400 text-sm">Total Saldo</p>
  <h2 id="totalBalance" class="text-3xl font-bold text-blue-400 mt-1"></h2>
</div>

<!-- ACCOUNT CARDS -->
<div class="flex gap-3 overflow-x-auto mb-6">
  <div class="min-w-[140px] bg-[#1e293b] p-4 rounded-2xl">
    <p class="text-xs text-slate-400">Cash</p>
    <p id="cashBal" class="font-bold text-lg"></p>
  </div>
  <div class="min-w-[140px] bg-[#1e293b] p-4 rounded-2xl">
    <p class="text-xs text-slate-400">Bank</p>
    <p id="bankBal" class="font-bold text-lg"></p>
  </div>
  <div class="min-w-[140px] bg-[#1e293b] p-4 rounded-2xl">
    <p class="text-xs text-slate-400">Ewallet</p>
    <p id="ewalletBal" class="font-bold text-lg"></p>
  </div>
</div>

<!-- CHART -->
<div class="bg-[#1e293b] p-4 rounded-3xl mb-6">
  <canvas id="chart" height="180"></canvas>
</div>

<!-- TRANSACTION HISTORY -->
<div class="bg-[#1e293b] p-4 rounded-3xl">
  <h3 class="text-sm text-slate-400 mb-3">Transaksi Terakhir</h3>
  <div id="history" class="space-y-2 text-sm"></div>
</div>

</div>

<!-- FLOAT BUTTON -->
<button onclick="openModal()" 
class="fixed bottom-20 right-6 bg-blue-600 w-14 h-14 rounded-full text-2xl shadow-lg">
+
</button>

<!-- BOTTOM NAV -->
<div class="fixed bottom-0 w-full bg-[#1e293b] flex justify-around py-3 text-sm">
  <span>Dashboard</span>
  <span>Transaksi</span>
  <span>Rekening</span>
  <span>Profil</span>
</div>

<!-- MODAL -->
<div id="modal" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center">
  <div class="bg-[#1e293b] p-6 rounded-3xl w-80 space-y-3">
    <select id="accountType" class="w-full p-2 rounded text-black">
      <option value="Cash">Cash</option>
      <option value="Bank">Bank</option>
      <option value="Ewallet">Ewallet</option>
    </select>

    <input id="amount" type="number" placeholder="Jumlah"
           class="w-full p-2 rounded text-black"/>

    <select id="type" class="w-full p-2 rounded text-black">
      <option value="income">Income</option>
      <option value="expense">Expense</option>
    </select>

    <button onclick="addTransaction()" 
    class="w-full bg-blue-600 py-2 rounded-xl">
      Simpan
    </button>

    <button onclick="closeModal()" 
    class="w-full text-slate-400 text-sm">
      Batal
    </button>
  </div>
</div>

<script>
let data = JSON.parse(localStorage.getItem("cashpro")) || {
  accounts:{Cash:0,Bank:0,Ewallet:0},
  transactions:[]
}

function save(){
  localStorage.setItem("cashpro",JSON.stringify(data))
}

function openModal(){ modal.classList.remove("hidden") }
function closeModal(){ modal.classList.add("hidden") }

function addTransaction(){
  const acc = accountType.value
  const amt = parseInt(amount.value||0)
  const typeVal = type.value

  if(typeVal==="income") data.accounts[acc]+=amt
  else data.accounts[acc]-=amt

  data.transactions.push({acc,amt,typeVal})
  save()
  closeModal()
  render()
}

function render(){
  const total = Object.values(data.accounts).reduce((a,b)=>a+b,0)
  totalBalance.innerText="Rp "+total.toLocaleString()

  cashBal.innerText="Rp "+data.accounts.Cash.toLocaleString()
  bankBal.innerText="Rp "+data.accounts.Bank.toLocaleString()
  ewalletBal.innerText="Rp "+data.accounts.Ewallet.toLocaleString()

  new Chart(chart,{
    type:"doughnut",
    data:{
      labels:Object.keys(data.accounts),
      datasets:[{data:Object.values(data.accounts)}]
    },
    options:{plugins:{legend:{display:false}}}
  })

  history.innerHTML=data.transactions.slice().reverse().map(t=>`
    <div class="flex justify-between">
      <span>${t.acc}</span>
      <span class="${t.typeVal==='income'?'text-green-400':'text-red-400'}">
      ${t.typeVal==='income'?'+':'-'} Rp ${t.amt.toLocaleString()}
      </span>
    </div>
  `).join("")
}

render()
</script>

</body>
</html>
